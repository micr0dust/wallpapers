# 古文明世界 Mini World

一個3D古文明發展桌面背景，使用Three.js構建，可作為Wallpaper Engine壁紙使用。

## 功能特色

### 🏗️ 建築系統

- **城堡**: 文明的中心，可花費10食物生產1村民，支援5人口（成本：100木材，大小：6x6x5）
- **塔樓**: 防禦建築，灰色圓柱配紅色圓錐屋頂（成本：10木材，大小：2x2x8）
- **房舍**: 住宅建築，支援5人口（成本：10木材，大小：4x4x4）
- **農田**: 食物生產建築，1村民採集，根據枯竭程度變色（成本：5木材，大小：6x6）

### 👥 村民系統

- 優先分配：種田 > 砍樹
- 智能尋路和工作分配
- 每2tick移動一步的真實感
- 只能在身上0木材時砍樹
- 砍樹10次後樹木消失，10秒後重生
- 農田採集需走到隨機點採集後回城堡上繳

### 🌳 環境系統

- 樹木聚集分佈：M/(N/10)個聚集點，總量M=(N/10)*(N/10)棵樹
- 樹木生成位置10格內不得有建築
- 建築防重疊機制
- 樹木砍伐與重生系統

### 📷 視覺效果

- 相機繞市中心自動旋轉
- 遠距離霧化效果
- 動態陰影和光照
- 現代3D渲染

## 遊戲規則

### 建築建造條件

- 新建築必須在現有建築5格範圍內（第一個建築除外）
- 建築不可重疊
- 需要足夠的木材資源

### AI建造策略

- 一有木材就建造建築，優先度：城堡 > 塔樓 > 房舍 > 農田
- 每建造8個塔樓，可以+1城堡上限（初始為1）
- 每建造3個房舍，可以+1塔樓上限（初始為0）
- 每建造3個農田，可以+1房舍上限（初始為0）
- 人口上限為200

### 村民行為

- **優先度**: 種田 > 砍樹
- **砍樹條件**: 身上木材為0時才能砍樹
- **農田工作**: 必須走到農田隨機點採集
- **資源上繳**: 回到城堡上繳木材和食物

### 資源系統

- **木材**: 村民砍樹獲得，用於建造建築
- **食物**: 農田產出，城堡花費10食物生產1村民
- **人口**: 每棟城堡和房舍各支援5人口，上限200

## 操作說明

### 鍵盤快捷鍵

- `C` - 建造城堡模式
- `T` - 建造塔樓模式  
- `H` - 建造房舍模式
- `F` - 建造農田模式
- `ESC` - 取消建造模式
- `空格` - 暫停/繼續遊戲

### 滑鼠操作

- 點擊UI按鈕選擇建築類型
- 在場景中點擊放置建築
- 建造模式下按鈕會變紅色

### UI界面

- **資源面板**: 顯示木材、食物、人口等
- **建築按鈕**: 選擇要建造的建築類型
- **控制按鈕**: 暫停和加速遊戲

## 技術架構

### 核心類別
- `Game`: 主遊戲管理器，處理UI和輸入
- `World`: 世界管理器，統一管理所有系統
- `Grid`: 1000x1000網格座標系統
- `CameraController`: 相機旋轉和霧效果控制

### 建築系統
- `Building`: 建築基類
- `Castle`, `Tower`, `Farm`: 具體建築實現
- `BuildingManager`: 建築統一管理

### 單位系統
- `Villager`: 村民類，包含AI行為
- `VillagerManager`: 村民群體管理
- `Tree`: 樹木類，支持砍伐和重生
- `TreeManager`: 樹木生態系統管理

## Wallpaper Engine 設置

### 可調參數
- **遊戲速度**: 0.1x - 3.0x
- **樹木數量**: 50 - 300棵
- **相機高度**: 50 - 200
- **相機距離**: 100 - 500
- **旋轉速度**: 0 - 0.02
- **霧效果**: 開啟/關閉
- **自動遊戲**: 開啟/關閉

### 安裝方法
1. 將整個`mini-world`資料夾複製到Wallpaper Engine壁紙目錄
2. 在Wallpaper Engine中選擇該壁紙
3. 調整設定參數到喜好的效果

## 開發說明

### 檔案結構
```
mini-world/
├── index.html          # 主頁面和UI
├── game.js            # 遊戲主控制器
├── world.js           # 世界管理器
├── grid.js            # 網格系統
├── camera-controller.js # 相機控制
├── buildings.js       # 建築系統
├── villager.js        # 村民系統
├── tree.js           # 樹木系統
├── project.json      # Wallpaper Engine配置
└── preview.jpg       # 預覽圖片
```

### 依賴項
- Three.js (r128) - 3D渲染引擎
- 現代瀏覽器支援WebGL

### 效能考量
- 使用物件池減少記憶體分配
- LOD系統（可進一步優化）
- 限制同時存在的實體數量
- 高效的碰撞檢測和尋路

## 未來擴展

### 可能的改進
- 更多建築類型（兵營、市場、工坊等）
- 不同的文明派系
- 更複雜的AI行為
- 季節變化和天氣系統
- 音效和背景音樂
- 多人文明互動

### 開發建議
- 模組化設計便於擴展
- 事件驅動架構
- 可配置的遊戲規則
- 存檔/讀檔功能

## 授權

此項目為開源項目，可自由修改和分發。

---

享受觀看您的古文明在桌面上發展壯大！ 🏛️✨
